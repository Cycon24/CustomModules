%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
% SU2 configuration file                                                       %
% Case description: Viscous flow through a radial cross-section of a swirler in pipe%
% Author: Brice Martinelli                                                     %
% Institution: University of Cincinnati                                        %
% Date: 2025.09.19                                                             %
% File Version 1.0.1                                                           %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% --- Mesh / I-O
MESH_FORMAT= SU2 
MESH_FILENAME = swirler_n6_c2_AoA10_NACA8412.su2

MATH_PROBLEM  = DIRECT
SOLVER        = NAVIER_STOKES
KIND_TURB_MODEL = NONE            % (set SA later if you want RANS)

RESTART_SOL= NO
WRT_RESTART_COMPACT= NO

% --- Gas & reference (Imperial)
SYSTEM_MEASUREMENTS= US 
FLUID_MODEL = STANDARD_AIR        %, FLUID_MIXTURE or COOLPROP
GAMMA_VALUE    = 1.4             % This gets overwritten to 1.4 anyways
GAS_CONSTANT   = 1716.49          % ft*lbf/(slug*R)
MACH_NUMBER    = 0.30
AOA            = 0.0
FREESTREAM_TEMPERATURE = 1660.0   % R (use 518.67 for a cool smoke test)
FREESTREAM_PRESSURE    = 2116.216 % lbf/ft^2 (1 atm)
REYNOLDS_NUMBER = 8.981e+04
REYNOLDS_LENGTH = 2 % 

% Reference length for pitching, rolling, and yawing non-dimensional moment
% Reference area for force coefficients (0 implies automatic calculation)
REF_LENGTH= 2.0
REF_AREA= 1.0


% --- Viscosity & thermal models
VISCOSITY_MODEL     = SUTHERLAND
MU_REF              = 3.737e-7     % slug/(ft*s) at MU_T_REF
MU_T_REF            = 518.67       % R
SUTHERLAND_CONSTANT = 198.72       % R
PRANDTL_LAM         = 0.72

% --- Boundaries
% Periodic (slave, master, rot_cx, rot_cy, rot_cz, rot_ax, rot_ay, rot_az, tx,ty,tz)
MARKER_PERIODIC = ( Symmetry2, Symmetry1) , (0.0, 0.0, 0.0), (0.0, 0.0, 0.0), (0.0, 0.0, 0.0)

% Inlet - total T [R], total P [lbf/ft^2], dir (unit)
MARKER_INLET   = ( Inlet, 1684.9, 2246.07, 1.0, 0.0, 0.0 )

% Outlet - static pressure (subsonic)
MARKER_OUTLET  = ( Outlet, 2110.216 )

% Walls - viscous no-slip, adiabatic BC
MARKER_HEATFLUX = ( Airfoils, 0.0 )

% --- Space discretization & numerics
NUM_METHOD_GRAD         = WEIGHTED_LEAST_SQUARES
MUSCL_FLOW              = YES
SLOPE_LIMITER_FLOW      = VENKATAKRISHNAN
VENKAT_LIMITER_COEFF    = 0.02

% Robust flux for internal subsonic flow
CONV_NUM_METHOD_FLOW    = ROE 
ENTROPY_FIX_COEFF       = 0.10
LOW_MACH_PREC           = YES
ROE_KAPPA               = 0.5
MIN_ROE_TURKEL_PREC     = 0.01
MAX_ROE_TURKEL_PREC     = 0.2

% --- Time (steady implicit), linear solver
TIME_DISCRE_FLOW       = EULER_IMPLICIT
LINEAR_SOLVER          = FGMRES
LINEAR_SOLVER_PREC     = ILU
LINEAR_SOLVER_ITER     = 120
LINEAR_SOLVER_ERROR    = 1e-6

% --- CFL (use the 6-parameter adaptation?)
CFL_NUMBER       = 0.5
CFL_ADAPT        = YES
CFL_ADAPT_PARAM  = ( 0.5, 1.05, 0.01, 3.0, 1e-3, 0 )
%                = (down, up, CFL_min, CFL_max, acceptable_lin_res, start_iter)


% --- Convergence settings 
ITER                 = 3000
CONV_STARTITER       = 50
CONV_RESIDUAL_MINVAL = -8
CONV_CAUCHY_ELEMS    = 100
CONV_CAUCHY_EPS      = 1e-6



% --- Output 
OUTPUT_FILES        = ( RESTART, PARAVIEW, SURFACE_CSV )
OUTPUT_WRT_FREQ     = 250
TABULAR_FORMAT      = CSV

% Need these? 
SOLUTION_FILENAME= solution_flow
SOLUTION_ADJ_FILENAME= solution_adj
CONV_FILENAME= history
RESTART_FILENAME= restart_flow
RESTART_ADJ_FILENAME= restart_adj

% vtu output
VOLUME_FILENAME= flow
VOLUME_ADJ_FILENAME= adjoint

% Objective func
GRAD_OBJFUNC_FILENAME= of_grad

% Surface outputs
SURFACE_FILENAME= surface_flow
SURFACE_ADJ_FILENAME= surface_adjoint

SCREEN_OUTPUT  = (INNER_ITER, WALL_TIME, RMS_DENSITY, RMS_MOMENTUM-X, RMS_MOMENTUM-Y, RMS_ENERGY)
MESH_OUT_FILENAME= mesh_out


% ----------------------- (Optional) switch to RANS-SA later -------------------------
% SOLVER          = RANS
% KIND_TURB_MODEL = SA
% SA_OPTIONS      = SA_NEGATIVE
% PRANDTL_TURB   = 0.90